- hosts: jen
  become: yes
  become_user: root
  become_method: sudo

  tasks:
    - name: Install packages and dependencies
      apt: name={{ item }} update_cache=yes state=present 
      with_items:
      - openjdk-8-jdk  
      - libfontconfig
      - libffi-dev
      - libncurses5-dev

    - name: Add the Jenkins public GPG key to the apt repo
      apt_key: url=http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key
               state=present 

    - name: Add Jenkins apt repo to the trusted sources list
      apt_repository: repo='deb http://pkg.jenkins-ci.org/debian binary/'
                      state=present

    - name: Install Jenkins server
      apt: name=jenkins state=present
    
    - name: Wait for Jenkins to start up
      wait_for: timeout=35

    - name: Get Jenkins password
      shell: cat /var/lib/jenkins/secrets/initialAdminPassword
      changed_when: false
      register: result

    - name: Password to entry jenkins
      debug:
        var: result.stdout
      

    #- name: Install additional Python packages
     # pip: name={{ item }} state=latest
      #with_items:
      #- ansible
      #- boto
      #- flake8
      #- passlib
     #- name: Install wget
      # apt:
      # name: wget

     #- name: Install jdk 8 java
      # apt: 
      # name: openjdk-8-jdk

     #- name: Install jdk 8 jre
      # apt:
      # name: openjdk-8-jre
      
     #- name: Install pip
      # apt:
        # name: python3-pip
         #update_cache: yes
         #state: present

      #- name: Descargar llave
       #shell: wget -q -O - https://pkg.jenkins.io/debian-stable/jenkins.io.key | sudo apt-key add -
       #apt_key:
        # url: "https://pkg.jenkins.io/debian/jenkins-ci.org.key"
        # state: present
       #command: wget -q -O - https://pkg.jenkins.io/debian-stable/jenkins.io.key | sudo apt-key add -
       
     #- name: Obtener repositorio Jenkins
      # shell: sh -c 'echo deb http://pkg.jenkins-ci.org/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'
       #apt_repository:
         #repo: deb http://pkg.jenkins.io/debian-stable binary/
         #update_cache: yes
         #state: present
       #command: sh -c 'echo deb http://pkg.jenkins-ci.org/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'
       
     #- name: Install Jenkins
      # apt:
        # name: jenkins
        # state: present
